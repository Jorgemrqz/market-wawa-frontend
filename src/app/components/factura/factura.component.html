<div class="page-container">
  <div class="form-container">
    <h1>Gestión de Cliente</h1>

    <form [formGroup]="clienteForm">
      <div class="input-group">
        <label>Cédula:</label>
        <input type="text" formControlName="cedula" />
        <button type="button" (click)="buscarCliente()">Buscar</button>
      </div>

      <div class="input-group">
        <label>Nombre:</label>
        <input type="text" formControlName="nombre" />
      </div>

      <div class="input-group">
        <label>Apellido:</label>
        <input type="text" formControlName="apellido" />
      </div>

      <div class="input-group">
        <label>Dirección:</label>
        <input type="text" formControlName="direccion" />
      </div>

      <div class="input-group">
        <label>Teléfono:</label>
        <input type="text" formControlName="telefono" />
      </div>

      <div class="input-group">
        <label>Email:</label>
        <input type="email" formControlName="email" />
      </div>

      <div class="message">{{ mensaje }}</div>

      <div class="button-group">
        <button type="button" class="register-button" (click)="registrarCliente()">Registrar Cliente</button>
        <button type="button" class="update-button" (click)="actualizarCliente()" [disabled]="!clienteExiste">Actualizar Cliente</button>
      </div>
    </form>
  </div>

  <!-- Sección de Factura - Ahora debajo del formulario de Cliente -->
  <div class="form-container">
    <h1>Gestión de Factura</h1>

    <form [formGroup]="facturaForm">
      <div class="input-group">
        <label>Productos:</label>
        <select formControlName="productoSeleccionado" (change)="seleccionarProducto()">
          <option *ngFor="let producto of productos" [value]="producto.id_producto">
            {{ producto.nombre }} - ${{ producto.precio }}
          </option>
        </select>
        <input type="number" formControlName="cantidad" placeholder="Cantidad" min="1" />
        <button type="button" (click)="agregarProducto()">Agregar</button>
      </div>    

      <table>
        <thead>
          <tr>
            <th>Producto</th>
            <th>Cantidad</th>
            <th>Precio Unitario</th>
            <th>Subtotal</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let detalle of detallesFactura">
            <td>{{ detalle.nombre }}</td>
            <td>{{ detalle.cantidad }}</td>
            <td>${{ detalle.precio_unitario }}</td>
            <td>${{ detalle.subtotal }}</td>
          </tr>
        </tbody>
      </table>

      <h3>Total: ${{ totalFactura }}</h3>

      <button type="button" (click)="crearFactura()">Crear Factura</button>
    </form>
  </div>
</div>
